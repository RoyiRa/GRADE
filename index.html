<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="The homepage for GRADE, a sample diversity metric for text-to-image models.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GRADE: a sample diversity metric</title>

  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <!--   <link rel="stylesheet" href="./static/css/bulma-slider.min.css"> -->
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/a_cookie.jpg">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <!--   <script src="./static/js/bulma-slider.min.js"></script> -->
  <script src="./static/js/index.js"></script>
</head>

<body>


  <div class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">


            <h1 class="title is-1 publication-title">GRADE: Quantifying Sample Diversity <br> in Text-to-Image Models</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://royi-rassin.netlify.app/">Royi Rassin</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://lovodkin93.github.io/">Aviv Slobodkin</a><sup>1</sup>,</span>
              <span class="author-block">
                <a href="https://shauli-ravfogel.netlify.app/">Shauli Ravfogel</a><sup>1,4</sup>,</span>
              <span class="author-block">
                <a href="https://twitter.com/ravfogel">Yanai Elazar</a><sup>2,3</sup>,</span>
              <span class="author-block">
                <a href="https://twitter.com/yoavgo?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">Yoav
                  Goldberg</a><sup>1,2</sup>,
              </span>
            </div>



            <div class="is-size-5 publication-authors">
              <span class="author-block">Bar-Ilan University</span><sup>1</sup>
              <span class="author-block">Allen Institute for AI</span><sup>2</sup>
              <span class="author-block">University of Washington</span><sup>3</sup>
              <span class="author-block">ETH, Zurich</span><sup>4</sup>

            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span>
                <!-- Code Link -->
                <span class="link-block">
                  <a href="https://github.com/RoyiRa/GRADE-Quantifying-sample-diversity-in-text-to-image-models"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
              </div>

              <!-- Dropdown menus and image display start here -->
              <div class="container">
                <div class="field">
                  <label class="label">Select Model</label>
                  <div class="control">
                    <div class="select is-rounded is-dark">
                      <select id="model-select">
                        <!-- Options will be populated by JavaScript -->
                      </select>
                    </div>
                  </div>
                </div>

                <div class="field">
                  <label class="label">Select Concept</label>
                  <div class="control">
                    <div class="select is-rounded is-dark">
                      <select id="concept-select">
                        <!-- Options will be populated by JavaScript -->
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Image Display -->
                <div class="field">
                  <label class="label">A sample of images from all prompts</label>
                  <div class="control">
                    <img id="result-image" src="" alt="Please select a model and a concept" style="max-width: 100%; height: auto;">
                  </div>
                </div>
              </div>
              <!-- Dropdown menus and image display end here -->
            </div>

            <div class="container">
            <!-- Concept Dropdown -->
            <div class="field">
              <label class="label">Select Concept</label>
              <div class="control">
                <div class="select is-rounded is-dark">
                  <select id="concept-dropdown">
                    <!-- Options will be populated by JavaScript -->
                  </select>
                </div>
              </div>
            </div>

            <!-- Question Dropdown -->
            <div class="field">
              <label class="label">Select Question</label>
              <div class="control">
                <div class="select is-rounded is-dark">
                  <select id="question-dropdown">
                    <!-- Options will be populated by JavaScript -->
                  </select>
                </div>
              </div>
            </div>

            <!-- Image to Display the Plot -->
          <div class="field">
            <label class="label">Plot</label>
            <div class="control">
              <img id="plot-image" src="" alt="Plot will be displayed here" style="max-width: 100%; height: auto;">
            </div>
          </div>



          </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This website is licensed under a <a rel="license"
                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
            <p>
              The source code of this website is taken from
              the <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> project page.
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <!-- JavaScript Code -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Initialize all elements with carousel class.
      var carousels = bulmaCarousel.attach('#results-carousel', {
        slidesToScroll: 1,
        slidesToShow: 1,
        pagination: false,
        loop: true,
        autoplay: false,
        autoplaySpeed: 5000,
      });

      // Loop on each carousel initialized
      for (var i = 0; i < carousels.length; i++) {
        // Add listener to  event
        carousels[i].on('before:show', state => {
          console.log(state);
        });
      }

      // Your JavaScript code for dropdown menus and image display starts here

      // List of models
      var models = ['sd-1.1', 'sd-1.4', 'sd-2.1', 'sdxl', 'sdxl-turbo', 'lcm-sdxl', 'sd-3', 'flux-dev', 'flux-schnell', 'deepfloyd-l', 'deepfloyd-m', 'deepfloyd-xl'];

      // List of concepts
      var concepts = ['a helmet', 'a bin', 'a telescope', 'a teapot', 'a rug', 'a parachute', 'a table', 'a chair', 'a spinning wheel', 'a ring', 'an ice cream', 'a cake', 'a suitcase', 'a clock', 'a book', 'a bottle', 'a lantern', 'a guitar', 'a uniform', 'a baseball bat', 'yogurt', 'a pair of headphones', 'an umbrella', 'a jewelry box', 'a window', 'a drawer', 'a cookie jar', 'a toolbox', 'a person', 'a balloon', 'a flower', 'a spacesuit', 'a car', 'a sandcastle', 'a sandwich', 'a pair of shoes', 'a torch', 'a neon sign', 'a box', 'an apple', 'a bag', 'a bear', 'a bell', 'hiking boots', 'a clown', 'a crown', 'a mailbox', 'a pot', 'a pillow', 'a pool', 'a popsicle', 'a pretzel', 'a princess', 'a refrigerator', 'a rope', 'a cookie', 'a cup of soda', 'a stick', 'a tie', 'a toy', 'a tree', 'cheese', 'a clothes iron', 'a banana', 'an egg', 'a fish', 'a flashlight', 'a tiara', 'a burger', 'a cow', 'a paintbrush', 'a vase', 'a dice', 'a cupcake', 'a magnifying glass', 'a frisbee', 'a picnic basket', 'a hat', 'a chess piece', 'a puzzle', 'a mask', 'a garden gnome', 'a pacifier', 'a sculpture', 'a tablecloth', 'a brick', 'a witch', 'a detective', 'a present', 'a door', 'a pair of glasses', 'a mirror', 'a coconut', 'a taxi', 'coffee', 'a hot dog', 'soap', 'popcorn', 'corn', 'a stroller'];

      // Get references to the select elements
      var modelSelect = document.getElementById('model-select');
      var conceptSelect = document.getElementById('concept-select');
      var resultImage = document.getElementById('result-image');


      // Populate model dropdown
      models.forEach(function (model) {
        var option = document.createElement('option');
        option.value = model;
        option.text = model;
        modelSelect.add(option);
      });

      modelSelect.value = 'flux-dev';

      // Populate concept dropdown
      concepts.forEach(function (concept) {
        var option = document.createElement('option');
        option.value = concept;
        option.text = concept;
        conceptSelect.add(option);
      });

      conceptSelect.value = 'a cake';

      // Event listeners for selection changes
      modelSelect.addEventListener('change', updateImage);
      conceptSelect.addEventListener('change', updateImage);

      updateImage();

      function updateImage() {
        var model = modelSelect.value;
        var concept = conceptSelect.value;

        if (model && concept) {
          // Construct the image path
          var imagePath = constructImagePath(model, concept);

          // Update the src attribute of the image
          resultImage.src = imagePath;

          // Update the alt attribute
          resultImage.alt = 'Image of ' + concept + ' generated by ' + model;
        }
      }

      function constructImagePath(model, concept) {
        // Clean up the concept to match the filename
        var conceptInFilename = concept;

        // Construct the image path
        var imagePath = 'static/images/grid_images/' + model + '/' + model + '_' + conceptInFilename + '_grid_images.jpg';

        return imagePath;
      }


      // Add error handling for the image
      resultImage.addEventListener('error', function() {
        resultImage.src = ''; // Remove the broken image
        alert('Image not found. Please try another combination.');
      });

      // Your JavaScript code ends here
    });





 document.addEventListener('DOMContentLoaded', function () {
  // Variables to store concepts and questions
  var conceptToQuestions = {};

  // Fetch the concepts_questions.csv file
  jQuery.get('static/concept_data/concepts_questions.csv', function (data) {
    parseConceptsQuestionsCSV(data);
  });

  // Function to parse the concepts_questions.csv
  function parseConceptsQuestionsCSV(data) {
    var lines = data.split('\n');
    // Remove header if present
    if (lines[0].startsWith('concept')) {
      lines.shift();
    }

    lines.forEach(function (line) {
      if (line.trim() !== '') {
        var parts = parseCSVLine(line);
        var concept = parts[0];
        var question = parts[1];

        if (!(concept in conceptToQuestions)) {
          conceptToQuestions[concept] = [];
        }
        conceptToQuestions[concept].push(question);
      }
    });

    populateConceptDropdown();
  }

  function parseCSVLine(str) {
    var result = [];
    var cur = '';
    var inQuotes = false;

    for (var i = 0; i < str.length; i++) {
      var c = str[i];

      if (c === '"') {
        if (inQuotes && str[i + 1] === '"') {
          cur += '"';
          i++;
        } else {
          inQuotes = !inQuotes;
        }
      } else if (c === ',' && !inQuotes) {
        result.push(cur);
        cur = '';
      } else {
        cur += c;
      }
    }
    result.push(cur);
    return result;
  }

  // Function to populate the concept dropdown
  function populateConceptDropdown() {
    var conceptDropdown = $('#concept-dropdown');
    conceptDropdown.empty();

    Object.keys(conceptToQuestions).forEach(function (concept) {
      var option = $('<option></option>').attr('value', concept).text(concept);
      conceptDropdown.append(option);
    });

    // Remove any existing event listeners
    conceptDropdown.off('change');

    // Add event listener for concept change
    conceptDropdown.on('change', function () {
      var selectedConcept = $(this).val();
      populateQuestionDropdown(selectedConcept);
    });

    // Trigger change event to populate questions for the first concept
    conceptDropdown.trigger('change');
  }

  // Function to populate the question dropdown
  function populateQuestionDropdown(concept) {
    var questionDropdown = $('#question-dropdown');
    questionDropdown.empty();

    var questions = conceptToQuestions[concept];
    questions.forEach(function (question) {
      var option = $('<option></option>').attr('value', question).text(question);
      questionDropdown.append(option);
    });

    // Remove any existing event listeners
    questionDropdown.off('change');

    // Add event listener for question change
    questionDropdown.on('change', function () {
      var selectedQuestion = $(this).val();
      loadPlotImage(concept, selectedQuestion);
    });

    // Trigger change event to load data for the first question
    questionDropdown.trigger('change');
  }

  // Function to load the plot image
  function loadPlotImage(concept, question) {
    // Construct the filename
    var filename = constructPlotFilename(concept, question);
    var filepath = 'static/images/plots/' + filename;

    // Update the image src
    $('#plot-image').attr('src', filepath);

    // Add error handling
    $('#plot-image').on('error', function () {
      alert('Image not found. Please try another combination.');
      $(this).attr('src', ''); // Remove the broken image
    });
  }

  // Function to construct the plot filename
  function constructPlotFilename(concept, question) {
    // Replace special characters with underscores
    var safeConcept = concept.replace(/[\/\\?%*:|"<>()', ]/g, '_');
    var safeQuestion = question.replace(/[\/\\?%*:|"<>()', ]/g, '_');
    var filename = 'plot_' + safeConcept + '_' + safeQuestion + '.jpg';
    return filename;
  }
});

  </script>

</body>
</html>